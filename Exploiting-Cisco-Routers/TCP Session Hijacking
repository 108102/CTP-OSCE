Source https://www.exploit-db.com/papers/13587

At the establishment of a TCP session the client starts by
sending a SYN-packet (SYN=synchronize) with an sequence number.

To hijack a session it is required to send a packet with a right
    seq-number, otherwise they are dropped. You have two options to get
    the right seq-number.
    
    
        Option A:
            You try to guess the right number. It is made up of 32bit
            so you _just_ have 4294967296 possibilities, good luck!

        Option B:
            You sniff the existing connection, this works at networks
            which use Hub's without problems, but to do this at a switched
            network you have one way:
                Man-in-the-Middle!


-------=[ 0x02b - Man-in-the-Middle

To get Man-in-the-Middle we use ARP Poison Routing.

In order to sniff the connection between two hosts the attacker
    sends a manipulated ARP packet to one of the hosts which contains
    the IP of the second host and the MAC of the attacker. So this host
    sends every packet that is meant for the second host to the attacker.
    The same is done with the other host, the attacker himself just
    forwards the packets, so he acts as an invisible intermediary, as
    Man-in-the-Middle.
    
        +------+                                             +------+
    |HOST-A| -------------------SWITCH------------------ |HOST-B|
    +------+   .................  |  .................   +------+
                               :  |  :
                               :  |  :
                               :  |  :
                               :  |  :
                              +--------+
        Hello [A], I am [B] > |ATTACKER| < Hello [B], I am [A]
                              +--------+
                              
                              
-------=[ 0x02c - Session Hijack

        Vulnerable to hijacking is every unencrypted connection.
    We start with the Man-in-the-Middle attack between the victim
    and the server, if the server is in another subnet we attack
    the gateway instead of the server. If everything is successful
    we are able to observe every single packet with a sniffer.
    
          To hijack the session we wait for a packet and use the infos
    from it: source IP, destination IP, source port, destination port,
    and the sequence number. With this data we create a own packet
    and send it instantly to the server. The server accepts it and
    increases the expected seq-number for the next one. As soon the
    next packet from the real client arrives the server drops it as
    outdated, so the client is desynchronized and loses the connection.
    
    
 -------=[ 0x03a - Tools

        There are many programs which do the complete thing by
    itself (Hunt, Juggernaut, T-Sight), but I got some problems
    with some of them.

        For the Man-in-the-Middle attack I will use the well known
    program "Ettercap". "Wireshark" does the sniffing for me
    and the hijack is done with "Shijack", everything of course
    on a Linux/GNU box.

    Shijack: http://packetstormsecurity.org/sniffers/shijack.tgz
    
    
    
    
    
    
-------=[ 0x03b - Scenario

        We aim to hijack a telnet session between a client
    and a server.
    
    Network:
    
       +--------+                                 +--------+
       | SERVER | <.......T..E..L..N..E..T......> | CLIENT |
       |10.0.0.1| --------------+  +--------------|10.0.0.2|
       +--------+               |  |              +--------+
                                |  |
                              +------+
                              |SWITCH|
                              +------+
                                 | 
                                 |
                             +--------+
                             |ATTACKER|
                             |10.0.0.3|
                             +--------+
                            
