Source: https://medium.com/bugbountywriteup/bugbounty-journey-from-lfi-to-rce-how-a69afe5a0899

While searching for the vulnerabilities, 
I found LFI in the target site- 
https://www.victimsite.com/forum/attachment-serve?name=../../../../../../../../../../etc/shadow&path=. 
As you can see parameter “name” was vulnerable to LFI.

Get access to some file may be log files which could provide some user controller input (in order to run some command) .

So I tried reading access logs ,error logs , different location to access them.

But it seems the user with which I got LFI didn’t have access to access logs files. 

“/proc/self/fd” provides symbolic shortcut to access logs and various other system related file. 
So I tried reading those in search for access logs-

and I run intruder over /proc/self/fd/{number} and one of the fd files provided me access to access logs —


and what caught my attention here was “referer” header because 
I knew that it was something which is under user controlled input. 

Time to execute some command. I added ‘referer’ header in the HTTP request , set its value to system(id) and forwarded it-

We get a good response, and we now have RCE. 
